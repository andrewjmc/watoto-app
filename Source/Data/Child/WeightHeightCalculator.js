'use strict'

// height in cm -> gender -> [ -3SD, -2SD, -1SD, MEDIAN ]
const tables = [
  // table 0 -> 0-23 months
  {
     45: { male: [  1.9,  2.0,  2.2,  2.4], female: [  1.9,  2.1,  2.3,  2.5] },
     46: { male: [  2.0,  2.2,  2.4,  2.6], female: [  2.0,  2.2,  2.4,  2.6] },
     47: { male: [  2.1,  2.3,  2.5,  2.8], female: [  2.2,  2.4,  2.6,  2.8] },
     48: { male: [  2.3,  2.5,  2.7,  2.9], female: [  2.3,  2.5,  2.7,  3.0] },
     49: { male: [  2.4,  2.6,  2.9,  3.1], female: [  2.4,  2.6,  2.9,  3.2] },
     50: { male: [  2.6,  2.8,  3.0,  3.3], female: [  2.6,  2.8,  3.1,  3.4] },
     51: { male: [  2.7,  3.0,  3.2,  3.5], female: [  2.8,  3.0,  3.3,  3.6] },
     52: { male: [  2.9,  3.2,  3.5,  3.8], female: [  2.9,  3.2,  3.5,  3.8] },
     53: { male: [  3.1,  3.4,  3.7,  4.0], female: [  3.1,  3.4,  3.7,  4.0] },
     54: { male: [  3.3,  3.6,  3.9,  4.3], female: [  3.3,  3.6,  3.9,  4.3] },
     55: { male: [  3.6,  3.8,  4.2,  4.5], female: [  3.5,  3.8,  4.2,  4.5] },
     56: { male: [  3.8,  4.1,  4.4,  4.8], female: [  3.7,  4.0,  4.4,  4.8] },
     57: { male: [  4.0,  4.3,  4.7,  5.1], female: [  3.9,  4.3,  4.6,  5.1] },
     58: { male: [  4.3,  4.6,  5.0,  5.4], female: [  4.1,  4.5,  4.9,  5.4] },
     59: { male: [  4.5,  4.8,  5.3,  5.7], female: [  4.3,  4.7,  5.1,  5.6] },
     60: { male: [  4.7,  5.1,  5.5,  6.0], female: [  4.5,  4.9,  5.4,  5.9] },
     61: { male: [  4.9,  5.3,  5.8,  6.3], female: [  4.7,  5.1,  5.6,  6.1] },
     62: { male: [  5.1,  5.6,  6.0,  6.5], female: [  4.9,  5.3,  5.8,  6.4] },
     63: { male: [  5.3,  5.8,  6.2,  6.8], female: [  5.1,  5.5,  6.0,  6.6] },
     64: { male: [  5.5,  6.0,  6.5,  7.0], female: [  5.3,  5.7,  6.3,  6.9] },
     65: { male: [  5.7,  6.2,  6.7,  7.3], female: [  5.5,  5.9,  6.5,  7.1] },
     66: { male: [  5.9,  6.4,  6.9,  7.5], female: [  5.6,  6.1,  6.7,  7.3] },
     67: { male: [  6.1,  6.6,  7.1,  7.7], female: [  5.8,  6.3,  6.9,  7.5] },
     68: { male: [  6.3,  6.8,  7.3,  8.0], female: [  6.0,  6.5,  7.1,  7.7] },
     69: { male: [  6.5,  7.0,  7.6,  8.2], female: [  6.1,  6.7,  7.3,  8.0] },
     70: { male: [  6.6,  7.2,  7.8,  8.4], female: [  6.3,  6.9,  7.5,  8.2] },
     71: { male: [  6.8,  7.4,  8.0,  8.6], female: [  6.5,  7.0,  7.7,  8.4] },
     72: { male: [  7.0,  7.6,  8.2,  8.9], female: [  6.6,  7.2,  7.8,  8.6] },
     73: { male: [  7.2,  7.7,  8.4,  9.1], female: [  6.8,  7.4,  8.0,  8.8] },
     74: { male: [  7.3,  7.9,  8.6,  9.3], female: [  6.9,  7.5,  8.2,  9.0] },
     75: { male: [  7.5,  8.1,  8.8,  9.5], female: [  7.1,  7.7,  8.4,  9.1] },
     76: { male: [  7.6,  8.3,  8.9,  9.7], female: [  7.2,  7.8,  8.5,  9.3] },
     77: { male: [  7.8,  8.4,  9.1,  9.9], female: [  7.4,  8.0,  8.7,  9.5] },
     78: { male: [  7.9,  8.6,  9.3, 10.1], female: [  7.5,  8.2,  8.9,  9.7] },
     79: { male: [  8.1,  8.7,  9.5, 10.3], female: [  7.7,  8.3,  9.1,  9.9] },
     80: { male: [  8.2,  8.9,  9.6, 10.4], female: [  7.8,  8.5,  9.2, 10.1] },
     81: { male: [  8.4,  9.1,  9.8, 10.6], female: [  8.0,  8.7,  9.4, 10.3] },
     82: { male: [  8.5,  9.2, 10.0, 10.8], female: [  8.1,  8.8,  9.6, 10.5] },
     83: { male: [  8.7,  9.4, 10.2, 11.0], female: [  8.3,  9.0,  9.8, 10.7] },
     84: { male: [  8.9,  9.6, 10.4, 11.3], female: [  8.5,  9.2, 10.1, 11.0] },
     85: { male: [  9.1,  9.8, 10.6, 11.5], female: [  8.7,  9.4, 10.3, 11.2] },
     86: { male: [  9.3, 10.0, 10.8, 11.7], female: [  8.9,  9.7, 10.5, 11.5] },
     87: { male: [  9.5, 10.2, 11.1, 12.0], female: [  9.1,  9.9, 10.7, 11.7] },
     88: { male: [  9.7, 10.5, 11.3, 12.2], female: [  9.3, 10.1, 11.0, 12.0] },
     89: { male: [  9.9, 10.7, 11.5, 12.5], female: [  9.5, 10.3, 11.2, 12.2] },
     90: { male: [ 10.1, 10.9, 11.8, 12.7], female: [  9.7, 10.5, 11.4, 12.5] },
     91: { male: [ 10.3, 11.1, 12.0, 13.0], female: [  9.9, 10.7, 11.7, 12.7] },
     92: { male: [ 10.5, 11.3, 12.2, 13.2], female: [ 10.1, 10.9, 11.9, 13.0] },
     93: { male: [ 10.7, 11.5, 12.4, 13.4], female: [ 10.2, 11.1, 12.1, 13.2] },
     94: { male: [ 10.8, 11.7, 12.6, 13.7], female: [ 10.4, 11.3, 12.3, 13.5] },
     95: { male: [ 11.0, 11.9, 12.8, 13.9], female: [ 10.6, 11.5, 12.6, 13.7] },
     96: { male: [ 11.2, 12.1, 13.1, 14.1], female: [ 10.8, 11.7, 12.8, 14.0] },
     97: { male: [ 11.4, 12.3, 13.3, 14.4], female: [ 11.0, 12.0, 13.0, 14.2] },
     98: { male: [ 11.6, 12.5, 13.5, 14.6], female: [ 11.2, 12.2, 13.3, 14.5] },
     99: { male: [ 11.8, 12.7, 13.7, 14.9], female: [ 11.4, 12.4, 13.5, 14.8] },
    100: { male: [ 12.0, 12.9, 14.0, 15.2], female: [ 11.6, 12.6, 13.7, 15.0] },
    101: { male: [ 12.2, 13.2, 14.2, 15.4], female: [ 11.8, 12.8, 14.0, 15.3] },
    102: { male: [ 12.4, 13.4, 14.5, 15.7], female: [ 12.0, 13.1, 14.3, 15.6] },
    103: { male: [ 12.6, 13.6, 14.8, 16.0], female: [ 12.3, 13.3, 14.5, 15.9] },
    104: { male: [ 12.8, 13.9, 15.0, 16.3], female: [ 12.5, 13.6, 14.8, 16.2] },
    105: { male: [ 13.0, 14.1, 15.3, 16.6], female: [ 12.7, 13.8, 15.1, 16.5] },
    106: { male: [ 13.3, 14.4, 15.6, 16.9], female: [ 13.0, 14.1, 15.4, 16.9] },
    107: { male: [ 13.5, 14.6, 15.9, 17.3], female: [ 13.2, 14.4, 15.7, 17.2] },
    108: { male: [ 13.7, 14.9, 16.2, 17.6], female: [ 13.5, 14.7, 16.0, 17.6] },
    109: { male: [ 14.0, 15.1, 16.5, 17.9], female: [ 13.7, 15.0, 16.4, 18.0] },
    110: { male: [ 14.2, 15.4, 16.8, 18.3], female: [ 14.0, 15.3, 16.7, 18.3] },
  },
  // table 1 -> 2-5 years
  {
     65: { male: [  5.9,  6.3,  6.9,  7.4], female: [  5.6,  6.1,  6.6,  7.2] },
     66: { male: [  6.1,  6.5,  7.1,  7.7], female: [  5.8,  6.3,  6.8,  7.5] },
     67: { male: [  6.2,  6.7,  7.3,  7.9], female: [  5.9,  6.4,  7.0,  7.7] },
     68: { male: [  6.4,  6.9,  7.5,  8.1], female: [  6.1,  6.6,  7.2,  7.9] },
     69: { male: [  6.6,  7.1,  7.7,  8.4], female: [  6.3,  6.8,  7.4,  8.1] },
     70: { male: [  6.8,  7.3,  7.9,  8.6], female: [  6.4,  7.0,  7.6,  8.3] },
     71: { male: [  6.9,  7.5,  8.1,  8.8], female: [  6.6,  7.1,  7.8,  8.5] },
     72: { male: [  7.1,  7.7,  8.3,  9.0], female: [  6.7,  7.3,  8.0,  8.7] },
     73: { male: [  7.3,  7.9,  8.5,  9.2], female: [  6.9,  7.5,  8.1,  8.9] },
     74: { male: [  7.4,  8.0,  8.7,  9.4], female: [  7.0,  7.6,  8.3,  9.1] },
     75: { male: [  7.6,  8.2,  8.9,  9.6], female: [  7.2,  7.8,  8.5,  9.3] },
     76: { male: [  7.7,  8.4,  9.1,  9.8], female: [  7.3,  8.0,  8.7,  9.5] },
     77: { male: [  7.9,  8.5,  9.2, 10.0], female: [  7.5,  8.1,  8.8,  9.6] },
     78: { male: [  8.0,  8.7,  9.4, 10.2], female: [  7.6,  8.3,  9.0,  9.8] },
     79: { male: [  8.2,  8.8,  9.6, 10.4], female: [  7.8,  8.4,  9.2, 10.0] },
     80: { male: [  8.3,  9.0,  9.7, 10.6], female: [  7.9,  8.6,  9.4, 10.2] },
     81: { male: [  8.5,  9.2,  9.9, 10.8], female: [  8.1,  8.8,  9.6, 10.4] },
     82: { male: [  8.7,  9.3, 10.1, 11.0], female: [  8.3,  9.0,  9.8, 10.7] },
     83: { male: [  8.8,  9.5, 10.3, 11.2], female: [  8.5,  9.2, 10.0, 10.9] },
     84: { male: [  9.0,  9.7, 10.5, 11.4], female: [  8.6,  9.4, 10.2, 11.1] },
     85: { male: [  9.2, 10.0, 10.8, 11.7], female: [  8.8,  9.6, 10.4, 11.4] },
     86: { male: [  9.4, 10.2, 11.0, 11.9], female: [  9.0,  9.8, 10.7, 11.6] },
     87: { male: [  9.6, 10.4, 11.2, 12.2], female: [  9.2, 10.0, 10.9, 11.9] },
     88: { male: [  9.8, 10.6, 11.5, 12.4], female: [  9.4, 10.2, 11.1, 12.1] },
     89: { male: [ 10.0, 10.8, 11.7, 12.6], female: [  9.6, 10.4, 11.4, 12.4] },
     90: { male: [ 10.2, 11.0, 11.9, 12.9], female: [  9.8, 10.6, 11.6, 12.6] },
     91: { male: [ 10.4, 11.2, 12.1, 13.1], female: [ 10.0, 10.9, 11.8, 12.9] },
     92: { male: [ 10.6, 11.4, 12.3, 13.4], female: [ 10.2, 11.1, 12.0, 13.1] },
     93: { male: [ 10.8, 11.6, 12.6, 13.6], female: [ 10.4, 11.3, 12.3, 13.4] },
     94: { male: [ 11.0, 11.8, 12.8, 13.8], female: [ 10.6, 11.5, 12.5, 13.6] },
     95: { male: [ 11.1, 12.0, 13.0, 14.1], female: [ 10.8, 11.7, 12.7, 13.9] },
     96: { male: [ 11.3, 12.2, 13.2, 14.3], female: [ 10.9, 11.9, 12.9, 14.1] },
     97: { male: [ 11.5, 12.4, 13.4, 14.6], female: [ 11.1, 12.1, 13.2, 14.4] },
     98: { male: [ 11.7, 12.6, 13.7, 14.8], female: [ 11.3, 12.3, 13.4, 14.7] },
     99: { male: [ 11.9, 12.9, 13.9, 15.1], female: [ 11.5, 12.5, 13.7, 14.9] },
    100: { male: [ 12.1, 13.1, 14.2, 15.4], female: [ 11.7, 12.8, 13.9, 15.2] },
    101: { male: [ 12.3, 13.3, 14.4, 15.6], female: [ 12.0, 13.0, 14.2, 15.5] },
    102: { male: [ 12.5, 13.6, 14.7, 15.9], female: [ 12.2, 13.3, 14.5, 15.8] },
    103: { male: [ 12.8, 13.8, 14.9, 16.2], female: [ 12.4, 13.5, 14.7, 16.1] },
    104: { male: [ 13.0, 14.0, 15.2, 16.5], female: [ 12.6, 13.8, 15.0, 16.4] },
    105: { male: [ 13.2, 14.3, 15.5, 16.8], female: [ 12.9, 14.0, 15.3, 16.8] },
    106: { male: [ 13.4, 14.5, 15.8, 17.2], female: [ 13.1, 14.3, 15.6, 17.1] },
    107: { male: [ 13.7, 14.8, 16.1, 17.5], female: [ 13.4, 14.6, 15.9, 17.5] },
    108: { male: [ 13.9, 15.1, 16.4, 17.8], female: [ 13.7, 14.9, 16.3, 17.8] },
    109: { male: [ 14.1, 15.3, 16.7, 18.2], female: [ 13.9, 15.2, 16.6, 18.2] },
    110: { male: [ 14.4, 15.6, 17.0, 18.5], female: [ 14.2, 15.5, 17.0, 18.6] },
    111: { male: [ 14.6, 15.9, 17.3, 18.9], female: [ 14.5, 15.8, 17.3, 19.0] },
    112: { male: [ 14.9, 16.2, 17.6, 19.2], female: [ 14.8, 16.2, 17.7, 19.4] },
    113: { male: [ 15.2, 16.5, 18.0, 19.6], female: [ 15.1, 16.5, 18.0, 19.8] },
    114: { male: [ 15.4, 16.8, 18.3, 20.0], female: [ 15.4, 16.8, 18.4, 20.2] },
    115: { male: [ 15.7, 17.1, 18.6, 20.4], female: [ 15.7, 17.2, 18.8, 20.7] },
    116: { male: [ 16.0, 17.4, 19.0, 20.8], female: [ 16.0, 17.5, 19.2, 21.1] },
    117: { male: [ 16.2, 17.7, 19.3, 21.2], female: [ 16.3, 17.8, 19.6, 21.5] },
    118: { male: [ 16.5, 18.0, 19.7, 21.6], female: [ 16.6, 18.2, 19.9, 22.0] },
    119: { male: [ 16.8, 18.3, 20.0, 22.0], female: [ 16.9, 18.5, 20.3, 22.4] },
    120: { male: [ 17.1, 18.6, 20.4, 22.4], female: [ 17.3, 18.9, 20.7, 22.8] },
  }
]

module.exports = {
  getZScore: (gender, age, height, weight) => {
    if (!gender || !age || !height || !weight) return undefined
    if (age < 0 || age > 60) return undefined

    var table = tables[(age < 24?0:1)]

    var genderScores = table[height]
    if (!genderScores) return undefined

    var scores = genderScores[gender]
    if (!scores) return undefined

    if (weight > scores[3]) return 1
    else if (weight > scores[2]) return 0
    else if (weight > scores[1]) return -1
    else if (weight > scores[0]) return -2
    else if (weight <= scores[0]) return -3
    else return undefined
  },
  tables: () => { return tables }
}
